{"ast":null,"code":"var _s = $RefreshSig$();\nimport React, { useEffect } from \"react\";\nimport { auth, db } from \"../firebase\";\nimport { onAuthStateChanged, signOut } from \"firebase/auth\";\nimport { doc, getDoc, setDoc, serverTimestamp } from \"firebase/firestore\";\nimport { Fragment as _Fragment, jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function AuthListener({\n  children\n}) {\n  _s();\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, async user => {\n      if (user) {\n        if (user.emailVerified) {\n          const userDocRef = doc(db, \"users\", user.uid);\n          const userDocSnap = await getDoc(userDocRef);\n          if (!userDocSnap.exists()) {\n            const signupUserInfo = JSON.parse(localStorage.getItem(\"signupUserInfo\")) || {};\n            await setDoc(userDocRef, {\n              email: user.email,\n              firstName: signupUserInfo.firstName || \"\",\n              lastName: signupUserInfo.lastName || \"\",\n              createdAt: serverTimestamp()\n            });\n            localStorage.removeItem(\"signupUserInfo\");\n          }\n        } else {\n          alert(\"Please verify your email before logging in.\");\n          await signOut(auth);\n        }\n      }\n    });\n    return () => unsubscribe();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: children\n  }, void 0, false);\n}\n_s(AuthListener, \"OD7bBpZva5O2jO+Puf00hKivP7c=\");\n_c = AuthListener;\nvar _c;\n$RefreshReg$(_c, \"AuthListener\");","map":{"version":3,"names":["React","useEffect","auth","db","onAuthStateChanged","signOut","doc","getDoc","setDoc","serverTimestamp","Fragment","_Fragment","jsxDEV","_jsxDEV","AuthListener","children","_s","unsubscribe","user","emailVerified","userDocRef","uid","userDocSnap","exists","signupUserInfo","JSON","parse","localStorage","getItem","email","firstName","lastName","createdAt","removeItem","alert","_c","$RefreshReg$"],"sources":["/Users/ramtinabolfazli/Documents/Work/AIThink/AIThinkFinal/aithinkglobal/client/src/pages/Signup/AuthListener.js"],"sourcesContent":["import React, { useEffect } from \"react\";\nimport { auth, db } from \"../firebase\";\nimport { onAuthStateChanged, signOut } from \"firebase/auth\";\nimport { doc, getDoc, setDoc, serverTimestamp } from \"firebase/firestore\";\n\nexport default function AuthListener({ children }) {\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, async (user) => {\n      if (user) {\n        if (user.emailVerified) {\n          const userDocRef = doc(db, \"users\", user.uid);\n          const userDocSnap = await getDoc(userDocRef);\n\n          if (!userDocSnap.exists()) {\n            const signupUserInfo = JSON.parse(localStorage.getItem(\"signupUserInfo\")) || {};\n            await setDoc(userDocRef, {\n              email: user.email,\n              firstName: signupUserInfo.firstName || \"\",\n              lastName: signupUserInfo.lastName || \"\",\n              createdAt: serverTimestamp(),\n            });\n            localStorage.removeItem(\"signupUserInfo\");\n          }\n        } else {\n          alert(\"Please verify your email before logging in.\");\n          await signOut(auth);\n        }\n      }\n    });\n\n    return () => unsubscribe();\n  }, []);\n\n  return <>{children}</>;\n}\n"],"mappings":";AAAA,OAAOA,KAAK,IAAIC,SAAS,QAAQ,OAAO;AACxC,SAASC,IAAI,EAAEC,EAAE,QAAQ,aAAa;AACtC,SAASC,kBAAkB,EAAEC,OAAO,QAAQ,eAAe;AAC3D,SAASC,GAAG,EAAEC,MAAM,EAAEC,MAAM,EAAEC,eAAe,QAAQ,oBAAoB;AAAC,SAAAC,QAAA,IAAAC,SAAA,EAAAC,MAAA,IAAAC,OAAA;AAE1E,eAAe,SAASC,YAAYA,CAAC;EAAEC;AAAS,CAAC,EAAE;EAAAC,EAAA;EACjDf,SAAS,CAAC,MAAM;IACd,MAAMgB,WAAW,GAAGb,kBAAkB,CAACF,IAAI,EAAE,MAAOgB,IAAI,IAAK;MAC3D,IAAIA,IAAI,EAAE;QACR,IAAIA,IAAI,CAACC,aAAa,EAAE;UACtB,MAAMC,UAAU,GAAGd,GAAG,CAACH,EAAE,EAAE,OAAO,EAAEe,IAAI,CAACG,GAAG,CAAC;UAC7C,MAAMC,WAAW,GAAG,MAAMf,MAAM,CAACa,UAAU,CAAC;UAE5C,IAAI,CAACE,WAAW,CAACC,MAAM,CAAC,CAAC,EAAE;YACzB,MAAMC,cAAc,GAAGC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,gBAAgB,CAAC,CAAC,IAAI,CAAC,CAAC;YAC/E,MAAMpB,MAAM,CAACY,UAAU,EAAE;cACvBS,KAAK,EAAEX,IAAI,CAACW,KAAK;cACjBC,SAAS,EAAEN,cAAc,CAACM,SAAS,IAAI,EAAE;cACzCC,QAAQ,EAAEP,cAAc,CAACO,QAAQ,IAAI,EAAE;cACvCC,SAAS,EAAEvB,eAAe,CAAC;YAC7B,CAAC,CAAC;YACFkB,YAAY,CAACM,UAAU,CAAC,gBAAgB,CAAC;UAC3C;QACF,CAAC,MAAM;UACLC,KAAK,CAAC,6CAA6C,CAAC;UACpD,MAAM7B,OAAO,CAACH,IAAI,CAAC;QACrB;MACF;IACF,CAAC,CAAC;IAEF,OAAO,MAAMe,WAAW,CAAC,CAAC;EAC5B,CAAC,EAAE,EAAE,CAAC;EAEN,oBAAOJ,OAAA,CAAAF,SAAA;IAAAI,QAAA,EAAGA;EAAQ,gBAAG,CAAC;AACxB;AAACC,EAAA,CA7BuBF,YAAY;AAAAqB,EAAA,GAAZrB,YAAY;AAAA,IAAAqB,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}